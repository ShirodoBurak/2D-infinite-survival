using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class world_generator : MonoBehaviour
{
    [System.Serializable]
    public class noise_settings
    {
        public bool Ingore;
        [Space(10)]
        [Header("Settings")]
        public int Seed;
        public enum noise_type { Surface, Caves }
        public noise_type noiseType;
        public int octaves = 1;
        public float amplitude = 256;
        public float persistence = 1;
        public float frequency = 0.023f;
    }
    public noise_settings[] _settings;
    public _PerlinNoise perlinNoise;

    void Update(){
        if (Input.GetKeyDown(KeyCode.M))
        {
            generateImage();
        }
    }
    void generateImage()
    {
        
        if (_settings.Length > 0)
        {
            Texture2D perlin_image = new Texture2D(256, 256);
            perlinNoise = new _PerlinNoise(_settings[0].Seed,_settings[0].frequency);
            for (int x = 0; x < 256; x++)
            {
                for (int y = 0; y < 256; y++)
                {
                    float noise2d = perlinNoise.Sample2D(x, y) + 0f;
                    //for (int k = 0; k<_settings.Length-1;k++)
                   // {
                        //perlinNoise = new Noise(_settings[k].persistence, _settings[k].frequency, _settings[k].amplitude, _settings[k].octaves, _settings[k].Seed);
                        
                       // noise2d += perlinNoise.Noise(x,y)+0f;
                    //}
                    perlin_image.SetPixel(x, y, new Color(noise2d, noise2d, noise2d,1));
                }
            }
            Rect rec = new Rect(0, 0, perlin_image.width, perlin_image.height);
            this.gameObject.GetComponent<SpriteRenderer>().sprite = Sprite.Create(perlin_image, rec, new Vector2(0, 0));
        }
    }
}

